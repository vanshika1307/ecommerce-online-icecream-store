<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Frozen-Bites</title>
    <style>
      #chatbot-icon {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #007bff;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      #chatbot-icon img {
        width: 30px;
        height: 30px;
      }
      #chatbot-window {
        position: fixed;
        bottom: 90px;
        right: 20px;
        width: 300px;
        height: 400px;
        border: 1px solid #ccc;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        background: white;
        padding: 10px;
        display: none;
        flex-direction: column;
        justify-content: space-between;
      }
      #chatbot-messages {
        height: 300px;
        overflow-y: auto;
        margin-bottom: 10px;
      }
      #chatbot-input {
        width: calc(100% - 60px);
        padding: 5px;
      }
      #chatbot-send {
        width: 50px;
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <!--
      This HTML file is a template.
      If you open it directly in the browser, you will see an empty page.

      You can add webfonts, meta tags, or analytics to this file.
      The build step will place the bundled scripts into the <body> tag.

      To begin the development, run `npm start` or `yarn start`.
      To create a production bundle, use `npm run build` or `yarn build`.
    -->

    <!-- Chatbot Icon -->
    <div id="chatbot-icon">
      <img src="https://static.vecteezy.com/system/resources/thumbnails/007/225/199/small/robot-chat-bot-concept-illustration-vector.jpg" style="border-radius: 50%; width: 60px; height: 60px;" alt="Chatbot Icon" />
    </div>

    <!-- Chatbot Window -->
    <div id="chatbot-window">
      <div id="chatbot-messages"></div>
      <div>
        <input type="text" id="chatbot-input" placeholder="Type a message..." />
        <button id="chatbot-send">Send</button>
      </div>
    </div>

    <script>
      document.getElementById('chatbot-icon').addEventListener('click', () => {
        const chatbotWindow = document.getElementById('chatbot-window');
        chatbotWindow.style.display = chatbotWindow.style.display === 'none' ? 'flex' : 'none';
      });

      document.getElementById('chatbot-send').addEventListener('click', async () => {
        const input = document.getElementById('chatbot-input');
        const message = input.value;
        input.value = '';

        const messages = document.getElementById('chatbot-messages');
        const userMessage = document.createElement('div');
        userMessage.textContent = `You: ${message}`;
        messages.appendChild(userMessage);

        try {
          const response = await fetch('http://localhost:5000/chat', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ text: message }),
          });

          if (!response.ok) {
            throw new Error('Network response was not ok');
          }

          const data = await response.json();
          const botMessage = document.createElement('div');
          botMessage.textContent = `Bot: ${data.reply}`;
          messages.appendChild(botMessage);
        } catch (error) {
          console.error('Failed to fetch:', error);
          const errorMessage = document.createElement('div');
          errorMessage.textContent = 'Error: Failed to fetch response from server.';
          messages.appendChild(errorMessage);
        }
      });
    </script>
  </body>
</html>